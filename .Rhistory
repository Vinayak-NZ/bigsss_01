SUM(is.na(data_imputed_new[[1]]$WFI_T2))
sum(is.na(data_imputed_new[[1]]$WFI_T2))
data_imputed_new <- list()
data_imputed_new[[1]] <- complete(data_imputed, 1)
data_imputed_new[[1]] <- cbind(data_input[, exclude_vars], data_imputed[[1]])
data_imputed_new[[1]] <- data_imputed_new[[1]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1_imp",
"SCON_T2_imp",
"WFI_T1_imp",
"WFI_T2_imp")]
data_imputed_new <- list()
data_imputed_new[[1]] <- complete(data_imputed, 1)
data_imputed_new[[1]] <- cbind(data_input[, exclude_vars], data_imputed[[1]])
data_imputed_new[[1]] <- data_imputed_new[[1]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
setDT(data_imputed_new[[1]])
data_imputed[[i]] <- melt(data_imputed[[i]],
id.vars = c("id",
"Group",
"Age",
"v_236",
"education_cat"),
variable.name = "time",
value.name = c("SCON", "WFI"))
setDT(data_imputed_new[[1]])
data_imputed_new[[1]] <- melt(data_imputed_new[[1]],
id.vars = c("id",
"Group",
"Age",
"v_236",
"education_cat"),
variable.name = "time",
value.name = c("SCON", "WFI"))
data_imputed_new[[1]] <- melt(data_imputed_new[[1]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
variable.name = "time",
value.name = c("SCON", "WFI"))
data_imputed_new[[1]] <- melt(data_imputed_new[[1]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
variable.name = "time",
value.name = c("SCON", "SCON", "WFI", "WFI"))
data_imputed_new[[1]] <- melt(data_imputed_new[[1]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
variable.name = "time")
test<-data_imputed_new[[1]]
View(test)
data_imputed_new[[1]] <- melt(data_imputed_new[[1]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = c("SCON_T1", "SCON_T2", "WFI_T1", "WFI_T2"),
variable.name = "time")
data_imputed_new[[1]] <- melt(data_imputed_new[[1]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2"), c("WFI_T1", "WFI_T2")),
variable.name = "time",
value.name = c("SCON", "WFI"))
data_imputed_new <- list()
data_imputed_new[[1]] <- complete(data_imputed, 1)
data_imputed_new[[1]] <- cbind(data_input[, exclude_vars], data_imputed[[1]])
data_imputed_new[[1]] <- data_imputed_new[[1]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
setDT(data_imputed_new[[1]])
data_imputed_new[[1]] <- melt(data_imputed_new[[1]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2"), c("WFI_T1", "WFI_T2")),
variable.name = "time",
value.name = c("SCON", "WFI"))
test <- data_imputed_new[[1]]
View(test)
data_imputed_new <- list()
data_imputed_new[[1]] <- complete(data_imputed, 1)
test <- data_imputed_new[[1]]
View(test)
data_imputed_new[[1]] <- cbind(data_input[, exclude_vars], data_imputed[[1]])
test <- data_imputed_new[[1]]
summary(test$WFI_T2)
data_input[, exclude_vars]
data_imputed_new <- list()
data_imputed_new[[1]] <- complete(data_imputed, 1)
data_imputed_new[[1]] <- cbind(data_input[, exclude_vars], data_imputed_new[[1]])
data_imputed_new[[1]] <- data_imputed_new[[1]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
setDT(data_imputed_new[[1]])
data_imputed_new[[1]] <- melt(data_imputed_new[[1]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2"), c("WFI_T1", "WFI_T2")),
variable.name = "time",
value.name = c("SCON", "WFI"))
test <- data_imputed_new[[1]]
View(test)
summary(data_input_merged$SCON_T2)
data_input_merged$id <- 1:nrow(data_input_merged)
data_input <- data_input_merged[, c("id",
"Group",
"Age",
"v_236",
"v_534",
"v_534_P1",
"v_3",
"v_4",
"v_5",
"v_6",
"v_7",
"v_8",
"v_9",
"v_10",
"v_11",
"v_12",
"v_13",
"v_14",
"v_15",
"v_16",
"v_17",
"v_18",
"v_19",
"v_20",
"v_21",
"v_22",
"v_23",
"v_24",
"v_25",
"v_449",
"v_531",
"v_286",
"v_287",
"WFI_T1",
"WFI_T2",
"SCON_T1",
"SCON_T2")]
data_input$SCON_T2 <- ifelse(data_input$SCON_T2 < 0, NA,
data_input$SCON_T2)
# exclude variables from imputation
exclude_vars <- c("id", "Group", "Age", "v_236")
# identify variables to impute
vars_to_impute <- setdiff(names(data_input), exclude_vars)
data_impute_input <- data_input[, vars_to_impute]
# impute data
data_imputed <- mice(data_impute_input,
m = 5,
maxit = 33,
seed = 123)
# create single imputed dataset
data_imputed_pooled <- merge_imputations(data_impute_input,
data_imputed,
ori = data_impute_input)
data_imputed_new <- list()
data_imputed_new[[1]] <- complete(data_imputed, 1)
data_imputed_new[[1]] <- cbind(data_input[, exclude_vars], data_imputed_new[[1]])
data_imputed_new[[1]] <- data_imputed_new[[1]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
setDT(data_imputed_new[[1]])
data_imputed_new[[1]] <- melt(data_imputed_new[[1]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2"), c("WFI_T1", "WFI_T2")),
variable.name = "time",
value.name = c("SCON", "WFI"))
test <- data_imputed_new[[1]]
View(test)
summary(test$time)
data_imputed_new[[1]][, "time"] <- ifelse(data_imputed_new[[1]][, "time"] == 1,
"baseline", "follow-up")
data_imputed[[1]]$time <- as.factor(data_imputed[[1]]$time)
data_imputed[[1]][[var]] <- abs(as.numeric(data_imputed[[1]][[var]]))
data_imputed[[1]] <- as.data.frame(data_imputed[[1]])
data_imputed_new[[1]]$time <- as.factor(data_imputed_new[[1]]$time)
data_imputed_new[[1]][[var]] <- abs(as.numeric(data_imputed_new[[1]][[var]]))
data_imputed_new[[1]] <- as.data.frame(data_imputed_new[[1]])
test <- data_imputed_new[[1]]
View(data_input_merged)
View(test)
# impute data
data_imputed <- mice(data_impute_input,
m = 5,
maxit = 33,
seed = 123)
# create single imputed dataset
data_imputed_pooled <- merge_imputations(data_impute_input,
data_imputed,
ori = data_impute_input)
# create mice output
data_imputed_output <- list()
for (i in 1:length(data_imputed)){
data_imputed_output[[i]] <- complete(data_imputed, i)
data_imputed_output[[i]] <- cbind(data_input[, exclude_vars], data_imputed_new[[i]])
}
# create mice output
data_imputed_output <- list()
for (i in 1:length(data_imputed)){
data_imputed_output[[i]] <- complete(data_imputed, i)
data_imputed_output[[i]] <- cbind(data_input[, exclude_vars], data_imputed_output[[i]])
}
# impute data
data_imputed <- mice(data_impute_input,
m = 5,
maxit = 33,
seed = 123)
length(data_imputed)
View(data_imputed)
# create mice output
data_imputed_output <- list()
for (i in 1:length(data_imputed$m)){
data_imputed_output[[i]] <- complete(data_imputed, i)
data_imputed_output[[i]] <- cbind(data_input[, exclude_vars], data_imputed_output[[i]])
}
for (i in 1:length(data_imputed_output)){
data_imputed_output[[i]] <- data_imputed_output[[i]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
setDT(data_imputed_output[[i]])
data_imputed_output[[i]] <- melt(data_imputed_output[[i]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2"), c("WFI_T1", "WFI_T2")),
variable.name = "time",
value.name = c("SCON", "WFI"))
data_imputed_output[[i]][, "time"] <- ifelse(data_imputed_output[[i]][, "time"] == 1,
"baseline", "follow-up")
data_imputed_output[[i]]$time <- as.factor(data_imputed_output[[i]]$time)
data_imputed_output[[i]][[var]] <- abs(as.numeric(data_imputed_output[[i]][[var]]))
data_imputed_output[[i]] <- as.data.frame(data_imputed_output[[i]])
}
View(data_imputed_output)
lenght(data_imputed$m)
length(data_imputed$m)
# create mice output
data_imputed_output <- list()
for (i in 1:data_imputed$m){
data_imputed_output[[i]] <- complete(data_imputed, i)
data_imputed_output[[i]] <- cbind(data_input[, exclude_vars], data_imputed_output[[i]])
}
for (i in 1:length(data_imputed_output)){
data_imputed_output[[i]] <- data_imputed_output[[i]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
setDT(data_imputed_output[[i]])
data_imputed_output[[i]] <- melt(data_imputed_output[[i]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2"), c("WFI_T1", "WFI_T2")),
variable.name = "time",
value.name = c("SCON", "WFI"))
data_imputed_output[[i]][, "time"] <- ifelse(data_imputed_output[[i]][, "time"] == 1,
"baseline", "follow-up")
data_imputed_output[[i]]$time <- as.factor(data_imputed_output[[i]]$time)
data_imputed_output[[i]][[var]] <- abs(as.numeric(data_imputed_output[[i]][[var]]))
data_imputed_output[[i]] <- as.data.frame(data_imputed_output[[i]])
}
i <- 1
data_imputed_output[[i]] <- data_imputed_output[[i]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
# create mice output
data_imputed_output <- list()
data_imputed_output[[i]] <- complete(data_imputed, i)
View(data_imputed_output)
data_imputed_output[[i]] <- cbind(data_input[, exclude_vars], data_imputed_output[[i]])
View(data_imputed_output)
data_imputed_output[[i]] <- data_imputed_output[[i]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
setDT(data_imputed_output[[i]])
data_imputed_output[[i]] <- melt(data_imputed_output[[i]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2"), c("WFI_T1", "WFI_T2")),
variable.name = "time",
value.name = c("SCON", "WFI"))
data_imputed_output[[i]][, "time"] <- ifelse(data_imputed_output[[i]][, "time"] == 1,
"baseline", "follow-up")
data_imputed_output[[i]]$time <- as.factor(data_imputed_output[[i]]$time)
data_imputed_output[[i]][[var]] <- abs(as.numeric(data_imputed_output[[i]][[var]]))
data_imputed_output[[i]] <- as.data.frame(data_imputed_output[[i]])
data_imputed_output[[i]][["SCON"]] <- abs(as.numeric(data_imputed_output[[i]][["SCON"]]))
data_imputed_output[[i]][["WFI"]] <- abs(as.numeric(data_imputed_output[[i]][["WFI"]]))
data_imputed_output[[i]] <- as.data.frame(data_imputed_output[[i]])
source("R/00_load_packages.R")
source("R/01_load_data.R")
source("R/02_edit_data.R")
source("R/03_impute_data.R")
for (i in 1:length(data_imputed_output)){
data_imputed_output[[i]] <- data_imputed_output[[i]][, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
setDT(data_imputed_output[[i]])
data_imputed_output[[i]] <- melt(data_imputed_output[[i]],
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2"), c("WFI_T1", "WFI_T2")),
variable.name = "time",
value.name = c("SCON", "WFI"))
data_imputed_output[[i]][, "time"] <- ifelse(data_imputed_output[[i]][, "time"] == 1,
"baseline", "follow-up")
data_imputed_output[[i]]$time <- as.factor(data_imputed_output[[i]]$time)
data_imputed_output[[i]][["SCON"]] <- abs(as.numeric(data_imputed_output[[i]][["SCON"]]))
data_imputed_output[[i]][["WFI"]] <- abs(as.numeric(data_imputed_output[[i]][["WFI"]]))
data_imputed_output[[i]] <- as.data.frame(data_imputed_output[[i]])
}
test <- data_imputed_output[[4]]
View(test)
model_01 <- WFI ~ Group*time + SCON*time + Age + v_236 + (1|unique_id)
model_02 <- SCON ~ Group*Time + Age + v_236 + (1|unique_id)
mice_models_01 <- list()
mice_models_02 <- list()
mice_models_summary_01 <- list()
mice_models_summary_02 <- list()
M <- length(data_imputed_output)
for (mm in 1:M){
mice_models_01[[mm]] <- lme4::lmer(model_01, data = data_imputed_output[[mm]], REML=FALSE)
mice_models_summary_01[[mm]] <- summary(mice_models_01[[mm]])$coefficients[2]
mice_models_02[[mm]] <- lme4::lmer(model_02, data = data_imputed_output[[mm]], REML=FALSE)
mice_models_summary_02[[mm]] <- summary(mice_models_02[[mm]])$coefficients[2]
}
model_01 <- WFI ~ Group*time + SCON*time + Age + v_236 + (1|id)
model_02 <- SCON ~ Group*Time + Age + v_236 + (1|id)
mice_models_01 <- list()
mice_models_02 <- list()
mice_models_summary_01 <- list()
mice_models_summary_02 <- list()
M <- length(data_imputed_output)
for (mm in 1:M){
mice_models_01[[mm]] <- lme4::lmer(model_01, data = data_imputed_output[[mm]], REML=FALSE)
mice_models_summary_01[[mm]] <- summary(mice_models_01[[mm]])$coefficients[2]
mice_models_02[[mm]] <- lme4::lmer(model_02, data = data_imputed_output[[mm]], REML=FALSE)
mice_models_summary_02[[mm]] <- summary(mice_models_02[[mm]])$coefficients[2]
}
model_01 <- WFI ~ Group*time + SCON*time + Age + v_236 + (1|id)
model_02 <- SCON ~ Group*time + Age + v_236 + (1|id)
mice_models_01 <- list()
mice_models_02 <- list()
mice_models_summary_01 <- list()
mice_models_summary_02 <- list()
M <- length(data_imputed_output)
for (mm in 1:M){
mice_models_01[[mm]] <- lme4::lmer(model_01, data = data_imputed_output[[mm]], REML=FALSE)
mice_models_summary_01[[mm]] <- summary(mice_models_01[[mm]])$coefficients[2]
mice_models_02[[mm]] <- lme4::lmer(model_02, data = data_imputed_output[[mm]], REML=FALSE)
mice_models_summary_02[[mm]] <- summary(mice_models_02[[mm]])$coefficients[2]
}
mice_pooled_model_01 <- lmer_pool(mice_models_01, level = .95)
library(miceadds)
mice_pooled_model_01 <- lmer_pool(mice_models_01, level = .95)
mice_pooled_model_01 <- lmer_pool(mice_models_01, level = .95)
mice_pooled_model_02 <- lmer_pool(mice_models_02, level = .95)
mice_pooled_output_model_01 <- summary(mice_pooled_model_01)
mice_pooled_output_model_02 <- summary(mice_pooled_model_02)
mice_treatment_effect_model_01 <- unlist(mice_models_summary_01, use.names=FALSE)
mice_treatment_effect_model_02 <- unlist(mice_models_summary_02, use.names=FALSE)
mice_treatment_effect_model_01
View(data_imputed_pooled)
test_model_01 <- lme4::lmer(WFI ~ Group*time + SCON*time + Age + v_236 + (1|id),
data = data_imputed_pooled,
REML=FALSE)
data_imputed_pooled <- data_imputed_pooled[, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
View(data_imputed_pooled)
data_imputed_pooled_all_all <- cbind(data_input[, exclude_vars], data_imputed_pooled)
data_imputed_pooled_all_all <- data_imputed_pooled_all[, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2",
"WFI_T1",
"WFI_T2")]
data_imputed_pooled_all_all <- cbind(data_input[, exclude_vars], data_imputed_pooled)
data_imputed_pooled_all <- data_imputed_pooled_all[, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2_imp",
"WFI_T1",
"WFI_T2_imp")]
data_imputed_pooled_all <- cbind(data_input[, exclude_vars], data_imputed_pooled)
data_imputed_pooled_all <- data_imputed_pooled_all[, c("id",
"Group",
"Age",
"v_236",
"SCON_T1",
"SCON_T2_imp",
"WFI_T1",
"WFI_T2_imp")]
setDT(data_imputed_pooled_all)
data_imputed_pooled_all <- melt(data_imputed_pooled_all,
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2"), c("WFI_T1", "WFI_T2")),
variable.name = "time",
value.name = c("SCON", "WFI"))
data_imputed_pooled_all <- melt(data_imputed_pooled_all,
id.vars = c("id",
"Group",
"Age",
"v_236"),
measure.vars = list(c("SCON_T1", "SCON_T2_imp"), c("WFI_T1", "WFI_T2_imp")),
variable.name = "time",
value.name = c("SCON", "WFI"))
data_imputed_pooled_all[, "time"] <- ifelse(data_imputed_pooled_all[, "time"] == 1,
"baseline", "follow-up")
data_imputed_pooled_all$time <- as.factor(data_imputed_pooled_all$time)
data_imputed_pooled_all[["SCON"]] <- abs(as.numeric(data_imputed_pooled_all[["SCON"]]))
data_imputed_pooled_all[["WFI"]] <- abs(as.numeric(data_imputed_pooled_all[["WFI"]]))
data_imputed_pooled_all <- as.data.frame(data_imputed_pooled_all)
test_model_01 <- lme4::lmer(WFI ~ Group*time + SCON*time + Age + v_236 + (1|id),
data = data_imputed_pooled_all,
REML=FALSE)
test_model_01
summary(test_model_01)
install.packages("ggplot2")
library(ggplot2)
ggplot(data_imputed_pooled_all, aes(x=time, y=WFI, color=Group)) +
geom_line(stat="summary", fun="mean") +
theme_minimal()
test_model_02 <- lme4::lmer(WFI ~ Group*time + Age + v_236 + (1|id),
data = data_imputed_pooled_all,
REML=FALSE)
summary(test_model_02)
test_model_02 <- lme4::lmer(SCON ~ Group*time + Age + v_236 + (1|id),
data = data_imputed_pooled_all,
REML=FALSE)
summary(test_model_02)
